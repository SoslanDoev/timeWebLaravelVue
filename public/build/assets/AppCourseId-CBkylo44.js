import{f as M,r as s,s as V,u as B,o as H,q as T,e as r,g as A,a as n,c,b as v,l as F,i as I,t as L,w as k,k as g,m as R}from"./app-BxmQDjrR.js";const S={class:"course__page"},q={class:"container"},E={class:"course__page-inner"},j={class:"title"},z=["innerHTML"],G={key:0},O={__name:"AppCourseId",setup(J){const t=M(),_=s(!1),w=s({}),u=s(!1),p=s(!1),N=V(),C=B(),a=s(null),l=s({name:"",html:null});H(async()=>{var d,m,f,h,b,y;w.value=T(()=>t.state.user),a.value=N.params.id;try{const o=await r.get(`/api/course/${a.value}`);l.value=((m=(d=o.data)==null?void 0:d.data)==null?void 0:m.data)||((f=o.data)==null?void 0:f.data)||o.data}catch(o){console.log(o)}l.value.user.id===t.state.user.id&&(_.value=!0),(t.state.user.role==="0"||t.state.user.role===0)&&(p.value=!0);const e=await r.get(`/api/favorites/${t.state.user.id}/${a.value}`);(((b=(h=e.data)==null?void 0:h.data)==null?void 0:b.data)||((y=e.data)==null?void 0:y.data)||e.data)===1&&(u.value=!0)});const D=async()=>{const e=Number(a.value);try{const i=await r.delete(`/api/course/${e}`);C.push({name:"Home"})}catch(i){console.log(i)}},$=async()=>{try{const e=await r.post("/api/favorites",{user_id:Number(t.state.user.id),course_id:Number(a.value)});u.value=!0}catch(e){console.log(e)}},x=async()=>{try{const e=await r.delete(`/api/favorites/${Number(t.state.user.id)}/${Number(a.value)}`);u.value=!1}catch(e){console.log(e)}};return(e,i)=>{const d=A("router-link");return n(),c("div",S,[v("div",q,[v("div",E,[F(d,{to:"/"},{default:I(()=>[R("Назад")]),_:1}),v("h2",j,L(l.value.name),1),v("div",{innerHTML:l.value.html},null,8,z),p.value===!0?(n(),c("div",G,[u.value==!0?(n(),c("button",{key:0,class:"btn",onClick:k(x,["prevent"])},"Отписаться на курс")):(n(),c("button",{key:1,class:"btn",onClick:k($,["prevent"])},"Записаться на курс"))])):g("",!0),_.value?(n(),c("button",{key:1,class:"btn",onClick:D},"Удалить")):g("",!0)])])])}}};export{O as default};
