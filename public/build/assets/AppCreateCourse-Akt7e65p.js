import{f as N,r as L,o as U,q as y,a as g,c as E,b as u,t as $,j as A,v as V,F as z,d as P,k as q}from"./app-iuemlvLu.js";const F={class:"form__create"},O={class:"container"},j=u("h2",{class:"title"},"Создание страницы курса",-1),Z={class:"form__create-inner"},G={key:0,class:"search"},J={class:"search__list"},K=["onClick"],Q=u("input",{type:"text",class:"input input--title",placeholder:"Добавить заголовок"},null,-1),X={__name:"AppCreateCourse",setup(R){const B=N(),C=L(!1),_=L(""),x=L([{id:1,placeholder:"Заголовок h1",title:"Заголовок_1",name:"h1"},{id:2,placeholder:"Заголовок h2",title:"Заголовок_2",name:"h2"},{id:3,placeholder:"Заголовок h3",title:"Заголовок_3",name:"h3"},{id:4,placeholder:"Заголовок h4",title:"Заголовок_4",name:"h4"},{id:5,placeholder:"Заголовок h5",title:"Заголовок_5",name:"h5"},{id:6,placeholder:"Абзац",title:"Абзац",name:"textarea"},{id:7,placeholder:"Ссылку",title:"Ссылка",name:"a",meta:{placeholder:"Название ссылки",name:"value"}},{id:8,placeholder:"Список",title:"Список",name:"ul"}]),i=L(null),f=L(""),I=L(0),H=t=>{I.value+=1;const a=document.createElement("div");if(a.classList.add("drop__zone"),a.setAttribute("draggable","true"),a.addEventListener("dragstart",e=>M(e,a)),t.name==="table"){const e=document.createElement("div");e.classList.add("table");const n=document.createElement("div"),o=document.createElement("button");o.classList.add("btn"),n.appendChild(o),n.classList.add("table__column"),o.addEventListener("click",()=>{const l=document.createElement("textarea");l.classList.add("input"),l.placeholder="Введите текст",n.appendChild(l)}),e.appendChild(n);const h=document.createElement("button");h.classList.add("btn"),h.innerHTML="+",n.appendChild(h),a.append(e),i.value.appendChild(a);return}else if(t.name==="ul"){const e=document.createElement("ul");e.classList.add("list__form-create");const n=document.createElement("button");n.classList.add("btn"),n.innerHTML="Добавить элемент";const o=l=>{const s=document.createElement("li"),d=document.createElement("textarea");d.classList.add("input"),d.placeholder="Введите текст",d.addEventListener("input",m=>{f.value=m.target.value,d.style.height="auto",d.style.height=`${d.scrollHeight}px`}),s.appendChild(d);const c=document.createElement("li"),r=document.createElement("button");r.classList.add("btn"),r.innerHTML="Создать вн. список",c.appendChild(r),s.appendChild(c),r.addEventListener("click",()=>{h(s)}),l.appendChild(s)},h=(l,s="list")=>{const d=document.createElement("ul");d.classList.add(s);const c=document.createElement("li"),r=document.createElement("button");r.classList.add("btn"),r.innerHTML="Добавить элемент",c.prepend(r),d.appendChild(c);const m=document.createElement("li"),v=document.createElement("button");v.classList.add("btn"),v.innerHTML="Создать вн. список",m.appendChild(v),d.appendChild(m),v.addEventListener("click",()=>{h(d,"list__list")}),r.addEventListener("click",()=>{o(d)}),l.appendChild(d)};n.addEventListener("click",()=>{o(e)}),e.appendChild(n),e.dataset.dom=t.name,a.append(e),i.value.appendChild(a);return}else if(t.name==="a"){const e=document.createElement("input");e.classList.add("input"),e.placeholder=`Введите ${t.placeholder}`;const n=document.createElement("input");n.classList.add("input"),n.placeholder=`${t.meta.placeholder}`,e.addEventListener("input",o=>{f.value=o.target.value}),n.addEventListener("input",o=>{f.value=o.target.value}),e.dataset.dom=t.name,a.appendChild(e),n.dataset.dom=t.meta.name,a.appendChild(n),i.value.appendChild(a);return}else if(t.name[0]==="h"){const e=document.createElement("input");e.classList.add("input"),e.placeholder=`Введите ${t.placeholder}`,e.addEventListener("input",n=>{f.value=n.target.value}),e.style.fontSize=t.name=="h1"?"32px":t.name=="h2"?"24px":t.name=="h3"?"19px":t.name=="h4"?"16px":t.name=="h5"?"14px":t.name=="h6"?"12px":"1rem",e.dataset.dom=t.name,a.appendChild(e),i.value.appendChild(a)}else if(t.name=="textarea"){const e=document.createElement("textarea");e.classList.add("input"),e.placeholder=`Введите ${t.placeholder}`,e.addEventListener("input",n=>{f.value=n.target.value,e.style.height="auto",e.style.height=`${e.scrollHeight}px`}),e.dataset.dom=t.name,a.appendChild(e),i.value.appendChild(a)}else return},p=L(null),M=(t,a)=>{p.value=a,t.dataTransfer.effectAllowed="move"},S=t=>{t.preventDefault();const a=Array.from(i.value.children),e=t.target.closest(".drop__zone");if(p.value&&e&&p.value!==e){const n=a.indexOf(e),o=a.indexOf(p.value);n>o?i.value.insertBefore(p.value,e.nextSibling):i.value.insertBefore(p.value,e)}p.value=null};U(()=>{i.value.addEventListener("dragover",t=>t.preventDefault()),i.value.addEventListener("drop",S)});const T=y(()=>_.value.length?x.value.filter(t=>t.title.toLowerCase().includes(_.value.toLowerCase().trim())):x.value),w=()=>{let t="";const a=l=>{if(!l||l.tagName!=="UL")throw new Error("The provided element is not a UL");const s=d=>{let c="<ul>";return d.childNodes.forEach(r=>{var m,v;if(r.tagName==="LI"){const b=((m=r.firstChild)==null?void 0:m.value)||((v=r.firstChild)==null?void 0:v.textContent)||"";if(b==="Добавить элемент"||b==="Создать вн. список")return;c+="<li>"+b;const k=Array.from(r.children).find(D=>D.tagName==="UL");k&&(c+=s(k)),c+="</li>"}}),c+="</ul>",c};return s(l)};i.value.childNodes.forEach(l=>{const s=l.firstChild.dataset.dom;if(s==="ul")t+=a(l.firstChild),t+="<br/>";else if(s==="a"){let d,c;for(const r of l.children)r.dataset.dom==="value"?d=r.value:r.dataset.dom==="a"&&(c=r.value);t+=`<a href="${c}">${d}</a><br/>`}else s=="textarea"?t+=`<p>${l.firstChild.value}</p><br/>`:t+=`<${s}>${l.firstChild.value}</${s}><br/>`}),console.log("33333333333333",t);const e=document.querySelector(".input--title"),o={user_id:y(()=>B.state.user).value.id,name:e.value,html:t};console.log("dadta",o),console.log((async l=>{try{const s=await axios.post("api/course",l);console.log(s)}catch(s){console.log(s)}})(o))};return(t,a)=>(g(),E("div",F,[u("div",O,[j,u("div",Z,[u("button",{class:"btn--add",onClick:a[0]||(a[0]=e=>C.value=!C.value)},$(C.value?"-":"+"),1),C.value?(g(),E("div",G,[A(u("input",{type:"text",class:"input",placeholder:"Поиск","onUpdate:modelValue":a[1]||(a[1]=e=>_.value=e)},null,512),[[V,_.value]]),u("ul",J,[(g(!0),E(z,null,P(T.value,e=>(g(),E("li",{class:"search__item",onClick:n=>H(e),key:e.id},$(e.title),9,K))),128))])])):q("",!0),Q,u("div",{ref_key:"formCreateInner",ref:i},null,512)]),u("button",{class:"btn",onClick:w},"Добавить")])]))}};export{X as default};
