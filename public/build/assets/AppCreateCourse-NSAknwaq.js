import{f as N,r as f,o as U,q as y,a as g,c as b,b as h,t as $,j as A,v as V,F as z,d as P,k as q}from"./app-BxmQDjrR.js";const F={class:"form__create"},O={class:"container"},j=h("h2",{class:"title"},"Создание страницы курса",-1),Z={class:"form__create-inner"},G={key:0,class:"search"},J={class:"search__list"},K=["onClick"],Q=h("input",{type:"text",class:"input input--title",placeholder:"Добавить заголовок"},null,-1),X={__name:"AppCreateCourse",setup(R){const B=N(),_=f(!1),E=f(""),x=f([{id:1,placeholder:"Заголовок h1",title:"Заголовок_1",name:"h1"},{id:2,placeholder:"Заголовок h2",title:"Заголовок_2",name:"h2"},{id:3,placeholder:"Заголовок h3",title:"Заголовок_3",name:"h3"},{id:4,placeholder:"Заголовок h4",title:"Заголовок_4",name:"h4"},{id:5,placeholder:"Заголовок h5",title:"Заголовок_5",name:"h5"},{id:6,placeholder:"Абзац",title:"Абзац",name:"textarea"},{id:7,placeholder:"Ссылку",title:"Ссылка",name:"a",meta:{placeholder:"Название ссылки",name:"value"}},{id:8,placeholder:"Список",title:"Список",name:"ul"}]),c=f(null),C=f(""),I=f(0),H=e=>{I.value+=1;const a=document.createElement("div");a.classList.add("drop__zone"),a.setAttribute("draggable","true"),a.addEventListener("dragstart",t=>M(t,a));const d=document.createElement("button");if(d.classList.add("btn"),d.innerHTML="Удалить",d.addEventListener("click",()=>{a.remove()}),a.appendChild(d),e.name==="table"){const t=document.createElement("div");t.classList.add("table");const n=document.createElement("div"),u=document.createElement("button");u.classList.add("btn"),n.appendChild(u),n.classList.add("table__column"),u.addEventListener("click",()=>{const s=document.createElement("textarea");s.classList.add("input"),s.placeholder="Введите текст",n.appendChild(s)}),t.appendChild(n);const r=document.createElement("button");r.classList.add("btn"),r.innerHTML="+",n.appendChild(r),a.append(t),c.value.appendChild(a);return}else if(e.name==="ul"){const t=document.createElement("ul");t.classList.add("list__form-create");const n=document.createElement("button");n.classList.add("btn"),n.innerHTML="Добавить элемент";const u=s=>{const p=document.createElement("li"),l=document.createElement("textarea");l.classList.add("input"),l.placeholder="Введите текст",l.addEventListener("input",L=>{C.value=L.target.value,l.style.height="auto",l.style.height=`${l.scrollHeight}px`}),p.appendChild(l);const o=document.createElement("li"),i=document.createElement("button");i.classList.add("btn"),i.innerHTML="Создать вн. список",o.appendChild(i),p.appendChild(o),i.addEventListener("click",()=>{r(p)}),s.appendChild(p)},r=(s,p="list")=>{const l=document.createElement("ul");l.classList.add(p);const o=document.createElement("li"),i=document.createElement("button");i.classList.add("btn"),i.innerHTML="Добавить элемент",o.prepend(i),l.appendChild(o);const L=document.createElement("li"),m=document.createElement("button");m.classList.add("btn"),m.innerHTML="Создать вн. список",L.appendChild(m),l.appendChild(L),m.addEventListener("click",()=>{r(l,"list__list")}),i.addEventListener("click",()=>{u(l)}),s.appendChild(l)};n.addEventListener("click",()=>{u(t)}),t.appendChild(n),t.dataset.dom=e.name,a.append(t),c.value.appendChild(a);return}else if(e.name==="a"){const t=document.createElement("input");t.classList.add("input"),t.placeholder=`Введите ${e.placeholder}`;const n=document.createElement("input");n.classList.add("input"),n.placeholder=`${e.meta.placeholder}`,t.addEventListener("input",u=>{C.value=u.target.value}),n.addEventListener("input",u=>{C.value=u.target.value}),t.dataset.dom=e.name,a.appendChild(t),n.dataset.dom=e.meta.name,a.appendChild(n),c.value.appendChild(a);return}else if(e.name[0]==="h"){const t=document.createElement("input");t.classList.add("input"),t.placeholder=`Введите ${e.placeholder}`,t.addEventListener("input",n=>{C.value=n.target.value}),t.style.fontSize=e.name=="h1"?"32px":e.name=="h2"?"24px":e.name=="h3"?"19px":e.name=="h4"?"16px":e.name=="h5"?"14px":e.name=="h6"?"12px":"1rem",t.dataset.dom=e.name,a.appendChild(t),c.value.appendChild(a)}else if(e.name=="textarea"){const t=document.createElement("textarea");t.classList.add("input"),t.placeholder=`Введите ${e.placeholder}`,t.addEventListener("input",n=>{C.value=n.target.value,t.style.height="auto",t.style.height=`${t.scrollHeight}px`}),t.dataset.dom=e.name,a.appendChild(t),c.value.appendChild(a)}else return},v=f(null),M=(e,a)=>{v.value=a,e.dataTransfer.effectAllowed="move"},T=e=>{e.preventDefault();const a=Array.from(c.value.children),d=e.target.closest(".drop__zone");if(v.value&&d&&v.value!==d){const t=a.indexOf(d),n=a.indexOf(v.value);t>n?c.value.insertBefore(v.value,d.nextSibling):c.value.insertBefore(v.value,d)}v.value=null};U(()=>{c.value.addEventListener("dragover",e=>e.preventDefault()),c.value.addEventListener("drop",T)});const S=y(()=>E.value.length?x.value.filter(e=>e.title.toLowerCase().includes(E.value.toLowerCase().trim())):x.value),w=()=>{let e="";const a=r=>{if(!r||r.tagName!=="UL")throw new Error("The provided element is not a UL");const s=p=>{let l="<ul>";return p.childNodes.forEach(o=>{var i,L;if(o.tagName==="LI"){const m=((i=o.firstChild)==null?void 0:i.value)||((L=o.firstChild)==null?void 0:L.textContent)||"";if(m==="Добавить элемент"||m==="Создать вн. список")return;l+="<li>"+m;const k=Array.from(o.children).find(D=>D.tagName==="UL");k&&(l+=s(k)),l+="</li>"}}),l+="</ul>",l};return s(r)};c.value.childNodes.forEach(r=>{const s=r.firstChild.dataset.dom;if(s==="ul")e+=a(r.firstChild),e+="<br/>";else if(s==="a"){let p,l;for(const o of r.children)o.dataset.dom==="value"?p=o.value:o.dataset.dom==="a"&&(l=o.value);e+=`<a href="${l}">${p}</a><br/>`}else s=="textarea"?e+=`<p>${r.firstChild.value}</p><br/>`:e+=`<${s}>${r.firstChild.value}</${s}><br/>`}),console.log(e);const d=document.querySelector(".input--title"),n={user_id:y(()=>B.state.user).value.id,name:d.value,html:e};console.log("dadta",n),console.log((async r=>{try{const s=await axios.post("api/course",r);console.log(s)}catch(s){console.log(s)}})(n))};return(e,a)=>(g(),b("div",F,[h("div",O,[j,h("div",Z,[h("button",{class:"btn--add",onClick:a[0]||(a[0]=d=>_.value=!_.value)},$(_.value?"-":"+"),1),_.value?(g(),b("div",G,[A(h("input",{type:"text",class:"input",placeholder:"Поиск","onUpdate:modelValue":a[1]||(a[1]=d=>E.value=d)},null,512),[[V,E.value]]),h("ul",J,[(g(!0),b(z,null,P(S.value,d=>(g(),b("li",{class:"search__item",onClick:t=>H(d),key:d.id},$(d.title),9,K))),128))])])):q("",!0),Q,h("div",{ref_key:"formCreateInner",ref:c},null,512)]),h("button",{class:"btn",onClick:w},"Добавить")])]))}};export{X as default};
