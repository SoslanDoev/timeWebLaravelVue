import{a as M,u as R,r as w,h as F,c as l,i as b,j as r,b as y,d as n,f as U,F as A,l as p,m as d,k as c,v as f,e as u,t as m,g as v,w as C,n as L}from"./app-Dp8iK4W1.js";import{_ as $}from"./AppActive-iTYP5dq1.js";import{A as j}from"./AppAuthSection-D0D-aP-n.js";import{_}from"./AppLabel-CHay-ZZK.js";const T=u("h2",{class:"title"},"Регистрация",-1),E={key:0},G={key:1},H={style:{display:"flex","justify-content":"space-between","align-items":"center"}},I=["value"],q={key:1,value:"-1"},z={key:2},J={key:3},K={key:4},O={key:5},ee={__name:"AppRegister",setup(P){const N=M(),k=R(),s=w({}),g=w([]),S=t=>{g.value.splice(t,1)},e=w({name:null,surname:null,group:null,email:null,password:null,password_confirmation:null}),h=w([]),V=async()=>{try{const t=await y.get("api/groups/");h.value=t.data.data}catch(t){console.log(t)}};V();const B=async(t,o)=>{y.post("/api/auth/login",{email:t,password:o}).then(i=>(console.log("auth",i),localStorage.setItem("access_token",i.data.access_token),k.commit("setAuth",i.data.access_token),k.dispatch("login"))).then(()=>{g.value.push("Вы успешно авторизировались"),N.push({name:"Home"})}).catch(i=>{console.log("err",i),g.value.push("Ошибка регистрации")})},D=()=>{s.value={},y.post("/api/users",{name:e.value.name,surname:e.value.surname,group_id:e.value.group,email:e.value.email,password:e.value.password,password_confirmation:e.value.password_confirmation}).then(t=>{B(e.value.email,e.value.password)}).catch(t=>{console.log(t),s.value=t.response.data.errors})};return(t,o)=>{const i=F("RouterLink");return l(),b(j,null,{default:r(()=>[(l(!0),n(A,null,U(g.value,(a,x)=>(l(),b($,{key:x,message:a,onDismissed:Q=>S(x)},null,8,["message","onDismissed"]))),128)),T,p(_,{to:"name"},{default:r(()=>[d("Введите имя *")]),_:1}),c(u("input",{id:"name",type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>e.value.name=a),class:"input",placeholder:"Введите имя"},null,512),[[f,e.value.name]]),s.value.name?(l(),n("p",E,m(s.value.name),1)):v("",!0),p(_,{to:"surname"},{default:r(()=>[d("Введите фамилию *")]),_:1}),c(u("input",{id:"surname",type:"text","onUpdate:modelValue":o[1]||(o[1]=a=>e.value.surname=a),class:"input",placeholder:"Введите фамилию"},null,512),[[f,e.value.surname]]),s.value.surname?(l(),n("p",G,m(s.value.surname),1)):v("",!0),u("div",H,[p(_,{to:"group"},{default:r(()=>[d("Выберите группу *")]),_:1}),u("a",{href:"#",onClick:C(V,["prevent"])},"Обновить")]),c(u("select",{class:"input",id:"group","onUpdate:modelValue":o[2]||(o[2]=a=>e.value.group=a)},[h.value?(l(!0),n(A,{key:0},U(h.value,a=>(l(),n("option",{key:a.id,value:Number(a.id)},m(a.name),9,I))),128)):(l(),n("option",q,"Пусто"))],512),[[L,e.value.group]]),s.value.group_id?(l(),n("p",z,m(s.value.group_id),1)):v("",!0),p(_,{to:"email"},{default:r(()=>[d("Введите почту *")]),_:1}),c(u("input",{id:"email",type:"email","onUpdate:modelValue":o[3]||(o[3]=a=>e.value.email=a),class:"input",placeholder:"Введите почту"},null,512),[[f,e.value.email]]),s.value.email?(l(),n("p",J,m(s.value.email),1)):v("",!0),p(_,{to:"password"},{default:r(()=>[d("Введите пароль *")]),_:1}),c(u("input",{id:"password",type:"password","onUpdate:modelValue":o[4]||(o[4]=a=>e.value.password=a),class:"input",placeholder:"Введите пароль"},null,512),[[f,e.value.password]]),s.value.password?(l(),n("p",K,m(s.value.password),1)):v("",!0),p(_,{to:"password_confirmation"},{default:r(()=>[d("Повторите пароль *")]),_:1}),c(u("input",{id:"password_confirmation",type:"password","onUpdate:modelValue":o[5]||(o[5]=a=>e.value.password_confirmation=a),class:"input",placeholder:"Повторите пароль"},null,512),[[f,e.value.password_confirmation]]),s.value.password_confirmation?(l(),n("p",O,m(s.value.password_confirmation),1)):v("",!0),u("button",{onClick:C(D,["prevent"]),class:"button hover",type:"submit"},"Отправить"),p(i,{to:"/login"},{default:r(()=>[d("Авторизация")]),_:1})]),_:1})}}};export{ee as default};
