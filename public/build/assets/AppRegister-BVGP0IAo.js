import{u as B,f as C,r as h,g as D,a as u,h as k,i as t,c,d as M,F as N,b as l,l as r,m as i,j as d,n as V,v,t as _,k as f,w as S,e as x}from"./app-BxmQDjrR.js";import{_ as F}from"./AppActive-czQzqbyx.js";import{A as L}from"./AppAuthSection-C4jFz5OS.js";import{_ as m}from"./AppLabel-DGWVFSkF.js";const $=l("h2",{class:"title"},"Регистрация",-1),T={style:{display:"flex",gap:"10px",width:"100%"}},j={key:0},E={key:1},H={key:2},I={key:3},q={key:4},Q={__name:"AppRegister",setup(z){const U=B(),y=C(),s=h({}),w=h([]),A=n=>{w.value.splice(n,1)},e=h({name:null,surname:null,role:0,email:null,password:null,password_confirmation:null}),R=async(n,a)=>{x.post("/api/auth/login",{email:n,password:a}).then(p=>(console.log("auth",p),localStorage.setItem("access_token",p.data.access_token),y.commit("setAuth",p.data.access_token),y.dispatch("login"))).then(()=>{w.value.push("Вы успешно авторизировались"),U.push({name:"Home"})}).catch(p=>{console.log("err",p),w.value.push("Ошибка регистрации")})},b=()=>{s.value={},x.post("/api/users",{name:e.value.name,surname:e.value.surname,role:e.value.role,email:e.value.email,password:e.value.password,password_confirmation:e.value.password_confirmation}).then(n=>{R(e.value.email,e.value.password)}).catch(n=>{console.log(n),s.value=n.response.data.errors})};return(n,a)=>{const p=D("RouterLink");return u(),k(L,null,{default:t(()=>[(u(!0),c(N,null,M(w.value,(o,g)=>(u(),k(F,{key:g,message:o,onDismissed:G=>A(g)},null,8,["message","onDismissed"]))),128)),$,l("div",T,[r(m,{for:"role_0"},{default:t(()=>[i("Ученик")]),_:1}),d(l("input",{id:"role_0",type:"radio",class:"input","onUpdate:modelValue":a[0]||(a[0]=o=>e.value.role=o),name:"role",value:"0",checked:""},null,512),[[V,e.value.role]]),r(m,{for:"role_1"},{default:t(()=>[i("Преподаватель")]),_:1}),d(l("input",{id:"role_1",type:"radio",class:"input","onUpdate:modelValue":a[1]||(a[1]=o=>e.value.role=o),name:"role",value:"2"},null,512),[[V,e.value.role]])]),r(m,{to:"name"},{default:t(()=>[i("Введите имя *")]),_:1}),d(l("input",{id:"name",type:"text","onUpdate:modelValue":a[2]||(a[2]=o=>e.value.name=o),class:"input",placeholder:"Введите имя"},null,512),[[v,e.value.name]]),s.value.name?(u(),c("p",j,_(s.value.name),1)):f("",!0),r(m,{to:"surname"},{default:t(()=>[i("Введите фамилию *")]),_:1}),d(l("input",{id:"surname",type:"text","onUpdate:modelValue":a[3]||(a[3]=o=>e.value.surname=o),class:"input",placeholder:"Введите фамилию"},null,512),[[v,e.value.surname]]),s.value.surname?(u(),c("p",E,_(s.value.surname),1)):f("",!0),r(m,{to:"email"},{default:t(()=>[i("Введите почту *")]),_:1}),d(l("input",{id:"email",type:"email","onUpdate:modelValue":a[4]||(a[4]=o=>e.value.email=o),class:"input",placeholder:"Введите почту"},null,512),[[v,e.value.email]]),s.value.email?(u(),c("p",H,_(s.value.email),1)):f("",!0),r(m,{to:"password"},{default:t(()=>[i("Введите пароль *")]),_:1}),d(l("input",{id:"password",type:"password","onUpdate:modelValue":a[5]||(a[5]=o=>e.value.password=o),class:"input",placeholder:"Введите пароль"},null,512),[[v,e.value.password]]),s.value.password?(u(),c("p",I,_(s.value.password),1)):f("",!0),r(m,{to:"password_confirmation"},{default:t(()=>[i("Повторите пароль *")]),_:1}),d(l("input",{id:"password_confirmation",type:"password","onUpdate:modelValue":a[6]||(a[6]=o=>e.value.password_confirmation=o),class:"input",placeholder:"Повторите пароль"},null,512),[[v,e.value.password_confirmation]]),s.value.password_confirmation?(u(),c("p",q,_(s.value.password_confirmation),1)):f("",!0),l("button",{onClick:S(b,["prevent"]),class:"button hover",type:"submit"},"Отправить"),r(p,{to:"/login"},{default:t(()=>[i("Авторизация")]),_:1})]),_:1})}}};export{Q as default};
